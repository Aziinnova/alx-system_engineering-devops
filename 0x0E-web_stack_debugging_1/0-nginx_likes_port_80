#!/usr/bin/env bash
# Script: nginx_setup.sh
# Description: Configures Nginx to listen on port 80 of all active IPv4 IPs

# Update package lists
apt update

# Install Nginx and net-tools
apt install -y nginx net-tools

# Check if any process is already using port 80
if ! netstat -tuln | grep -q ':80'; then
    # No process is using port 80, update Nginx configuration
    echo "Updating Nginx configuration..."
    sed -i 's/listen\s*80;/listen 80 default_server;/g' /etc/nginx/sites-available/default
fi

# Restart Nginx
service nginx restart

